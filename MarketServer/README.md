# Сервер маркета
Здесь представлена реализация маркета.

## Что реализовано:
1) Добавлена CRUD логика продуктов и категорий;
2) Написана и протестирована логика взаимосвязи продуктов и категорий (добавление категорий продукту, удаление категории из продукта);
3) Реализована логика регистрации и входа пользователя по токенам (в дальнейшем это понадобится для реализации логики покупки товаров);
4) На эндпоинты с созданием, удалением и обновлением объекта стоит фильтр. Доступ к этим эндпоинтам имеет только пользователь с ролью админа;
5) На все сервисы (кроме TokenService) и контроллеры написаны модульные и интеграционные тесты;
6) Добавлена swagger документация;
7) Настроен CI/CD для проверки работы сервиса во время push. На данный момент только три джобы: сбор приложения, запуск тестов, запуск контейнеров в докере;
8) Маркет можно запустить из докера.

## Документация
Список всех эндпоинтов: http://localhost:8080/api/v1/swagger-ui/index.html.

## Возможные проблемы при запуске
- Если вы счастливый обладатель windows, то сервис маркета может не запуститься. Если контейнер не поднялся, тогда необходимо в папке основного проекта поменять переменную окружающей среды (в файле .env) MARKET_DATABASE_HOST на ip-адрес wsl. Узнать ip-адрес можно по команде:
    ```
    ipconfig
    ```
  > ip-адрес может меняться при повторном включении устройства, поэтому периодически проверяйте адрес.
- При запуске интеграционных тестов используется testcontainers. Некоторые системы UNIX не дают разрешения на создание контейнера сторонним папкам. Позаботьтесь о предоставлении папке market нужных прав, если тесты не проходят.

## Запуск тестов
Для запуска тестов необходимо на устройстве иметь JDK и maven (версии были описаны в [главном readme](../README.md)). Далее запустить команду:
```
mvn test
```
В приложении подключен jacoco, поэтому при желании можно посмотреть репорт в папке target.

## План действий:
1) Реализовать логику покупки продуктов, протестировать ее;
2) Подключить debezium и проверить его работоспособность (не использовать kafka, хотя бы глянуть наличие логов);
3) Подключить kafka и создать необходимые топики, проверить работу.